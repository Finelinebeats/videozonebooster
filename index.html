<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vide√≥s Z√≥na - GitHub Pages</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #111;
            color: white;
            overflow-x: hidden;
            line-height: 1.6;
        }
        
        h1 {
            color: #ff6b6b;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        .subtitle {
            text-align: center;
            color: #a5b4fc;
            margin-bottom: 30px;
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        button {
            padding: 14px 24px;
            border: none;
            background: #222;
            color: white;
            border-radius: 10px;
            cursor: pointer;
            border: 2px solid #444;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 180px;
        }

        button:hover {
            background: #333;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        button:active {
            transform: translateY(-1px);
        }

        .start-btn {
            border-color: #4CAF50;
            background: linear-gradient(135deg, #2d5a2d, #4CAF50);
        }

        .stop-btn {
            border-color: #f44336;
            background: linear-gradient(135deg, #5a2d2d, #f44336);
        }

        .auto-btn {
            border-color: #9C27B0;
            background: linear-gradient(135deg, #4a2d5a, #9C27B0);
        }

        .timer-container {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .timer {
            font-size: 4rem;
            font-weight: bold;
            color: #ffd93d;
            margin: 15px 0;
            text-shadow: 0 2px 10px rgba(255, 217, 61, 0.3);
        }

        .timer-label {
            font-size: 1.1rem;
            color: #a5b4fc;
            opacity: 0.8;
        }

        .repeat-container {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .repeat-title {
            font-size: 1.2rem;
            color: #ffd93d;
            margin-bottom: 12px;
            font-weight: bold;
        }

        .repeat-info {
            font-size: 1rem;
            color: #a5b4fc;
            line-height: 1.8;
        }

        .batch-progress {
            display: flex;
            justify-content: space-between;
            margin: 25px 0;
            gap: 5px;
        }

        .batch-step {
            text-align: center;
            flex: 1;
            padding: 15px 10px;
            position: relative;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .batch-step.active {
            color: #ffd93d;
            background: rgba(255, 217, 61, 0.1);
            border: 1px solid rgba(255, 217, 61, 0.3);
        }

        .batch-step.completed {
            color: #4CAF50;
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid rgba(76, 175, 80, 0.3);
        }

        .batch-step::after {
            content: '';
            position: absolute;
            top: 50%;
            right: -2px;
            width: calc(100% + 4px);
            height: 2px;
            background: #333;
            z-index: -1;
        }

        .batch-step:last-child::after {
            display: none;
        }

        .batch-step.active::after {
            background: #ffd93d;
        }

        .batch-step.completed::after {
            background: #4CAF50;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin: 30px 0;
            font-size: 1rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #ffd93d;
            margin: 10px 0;
        }

        .stat-label {
            font-size: 0.95rem;
            color: #a5b4fc;
            opacity: 0.8;
        }

        .ad-stats {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            text-align: center;
            font-size: 1rem;
        }

        .ad-title {
            font-size: 1.3rem;
            color: #ffd93d;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .progress-container {
            width: 100%;
            height: 8px;
            background: #333;
            border-radius: 4px;
            margin: 25px 0;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #ffd93d);
            width: 0%;
            transition: width 0.5s ease;
        }

        .status {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            text-align: center;
            font-size: 1.1rem;
            border-left: 5px solid #ff6b6b;
            line-height: 1.6;
        }

        .domain-info {
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid #4CAF50;
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            text-align: center;
            font-size: 1rem;
        }

        .playback-stats {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .playback-title {
            font-size: 1.3rem;
            color: #ffd93d;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }

        .playback-info {
            font-size: 1rem;
            color: #a5b4fc;
            text-align: center;
            line-height: 1.8;
        }

        .tip {
            font-size: 0.95rem;
            color: #888;
            margin-top: 30px;
            text-align: center;
            line-height: 1.7;
            opacity: 0.8;
        }

        .loading {
            text-align: center;
            color: #ffd93d;
            margin: 25px 0;
            font-size: 1.1rem;
            padding: 20px;
        }

        .video-container {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
            margin: 25px 0;
            border-left: 5px solid #2196F3;
            position: relative;
            max-height: 400px;
            overflow-y: auto;
        }

        .video-title {
            font-size: 1.3rem;
            color: #ffd93d;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }

        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .video-player {
            background: #000;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .video-player:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }

        .player-container {
            width: 100%;
            height: 140px;
            background: #000;
            cursor: pointer;
            position: relative;
        }

        .video-info {
            padding: 12px;
            font-size: 0.85rem;
            color: #a5b4fc;
            text-align: center;
            background: rgba(0, 0, 0, 0.5);
        }

        .ad-indicator {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(255, 193, 7, 0.95);
            color: #000;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: bold;
            display: none;
            z-index: 5;
        }

        .play-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            color: #000;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0.9;
            transition: all 0.3s ease;
            font-size: 1.5rem;
            z-index: 10;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .play-button:hover {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1.1);
            background: rgba(255, 255, 255, 1);
        }

        .click-message {
            position: absolute;
            bottom: 8px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 0.8rem;
            color: #ffd93d;
            background: rgba(0, 0, 0, 0.8);
            padding: 4px;
            z-index: 5;
        }
        
        .batch-info {
            text-align: center;
            margin: 15px 0;
            font-size: 1.1rem;
            color: #a5b4fc;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        @media (max-width: 768px) {
            body {
                padding: 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            button {
                width: 100%;
                max-width: 300px;
            }
            
            .timer {
                font-size: 3rem;
            }
            
            .video-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            }
            
            .stats {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 10px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .video-grid {
                grid-template-columns: 1fr;
            }
            
            .batch-progress {
                flex-direction: column;
                gap: 10px;
            }
            
            .batch-step::after {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div id="am-experiment">
        <h1>üé¨ Vide√≥s Z√≥na - GitHub Pages</h1>
        <p class="subtitle">Optimaliz√°lva GitHub Pages domain-re - YouTube rekl√°mokkal</p>

        <!-- Domain inform√°ci√≥ -->
        <div class="domain-info" id="domainInfo">
            <div style="font-size: 1.2rem; margin-bottom: 10px;">üåê <strong>GitHub Pages Domain</strong></div>
            <div>Optim√°lis k√∂rnyezet YouTube rekl√°mokhoz</div>
            <div style="margin-top: 12px; font-size: 0.9rem; background: rgba(255,255,255,0.1); padding: 8px; border-radius: 6px;">
                Aktu√°lis domain: <span id="currentDomain">bet√∂lt√©s...</span>
            </div>
        </div>

        <!-- Rekl√°m statisztik√°k -->
        <div class="ad-stats">
            <div class="ad-title">üìä Rekl√°m Statisztik√°k</div>
            <div style="margin-bottom: 10px;">
                √ñsszes rekl√°m: <strong><span id="totalAds">0</span></strong> | 
                Sikeres rekl√°mok: <strong><span id="successfulAds">0</span></strong>
            </div>
            <div style="margin-bottom: 10px;">
                Rekl√°m bev√©tel becsl√©s: <strong>$<span id="adRevenue">0.00</span></strong>
            </div>
            <div style="font-size: 0.9rem; margin-top: 8px; padding: 8px; background: rgba(76, 175, 80, 0.2); border-radius: 6px; color: #4CAF50;" id="adStatus">
                ‚úÖ GitHub Pages domain - rekl√°mok akt√≠vak
            </div>
        </div>

        <!-- F≈ë vez√©rl≈ëk -->
        <div class="controls">
            <button class="start-btn" id="startButton">
                üöÄ Batch Bet√∂lt√©se
            </button>
            <button class="auto-btn" id="autoButton">
                üîÑ Automatikus Ism√©tl√©s
            </button>
            <button class="stop-btn" id="stopButton">
                ‚èπÔ∏è Minden Le√°ll√≠t√°sa
            </button>
        </div>

        <!-- Automatikus ism√©tl√©s inform√°ci√≥k -->
        <div class="repeat-container">
            <div class="repeat-title">üîÑ Automatikus Ism√©tl√©s</div>
            <div class="repeat-info">
                K√∂vetkez≈ë ind√≠t√°s: <strong><span id="nextStartTime">-</span></strong><br>
                Ism√©tl√©si id≈ëtartam: <strong><span id="repeatDuration">-</span> perc</strong><br>
                Aktu√°lis √°llapot: <strong><span id="autoStatus">Inakt√≠v</span></strong>
            </div>
        </div>

        <!-- Timer -->
        <div class="timer-container">
            <div class="timer" id="timer">00:00</div>
            <div class="timer-label" id="timerLabel">V√°rakoz√°s batch bet√∂lt√©s√©re</div>
        </div>

        <!-- Batch progress -->
        <div class="batch-progress" id="batchProgressContainer">
            <!-- Dinamikusan gener√°l√≥dik -->
        </div>

        <!-- Batch inform√°ci√≥k -->
        <div class="batch-info" id="batchInfo">
            Kattints a "Batch Bet√∂lt√©se" gombra a vide√≥k bet√∂lt√©s√©hez
        </div>

        <!-- Stats -->
        <div class="stats">
            <div class="stat-card">
                <div class="stat-value" id="readyCount">0</div>
                <div class="stat-label">Bet√∂lt√∂tt Player-ek</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="activeCount">0</div>
                <div class="stat-label">Akt√≠v Vide√≥k</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalCount">100</div>
                <div class="stat-label">√ñsszes Vide√≥</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="currentBatch">-</div>
                <div class="stat-label">Akt√≠v Batch</div>
            </div>
        </div>

        <!-- Progress bar -->
        <div class="progress-container">
            <div class="progress-bar" id="loadProgress"></div>
        </div>

        <!-- Playback statistics -->
        <div class="playback-stats">
            <div class="playback-title">üìä Lej√°tsz√°s Statisztik√°k</div>
            <div class="playback-info">
                <div style="margin-bottom: 10px;"><strong>√ñsszes lej√°tsz√°s: <span id="playbackCount">0</span></strong></div>
                <div id="monthlyStats">Havi bont√°s: M√©g nincs adat</div>
            </div>
        </div>

        <!-- Status √ºzenet -->
        <div class="status" id="statusMessage">
            GitHub Pages domain akt√≠v! Kattints a "Batch Bet√∂lt√©se" gombra a vide√≥k bet√∂lt√©s√©hez.
            A vide√≥k csak kattint√°sra fognak elindulni, √©s automatikus kattint√°sok szimul√°l√≥dnak.
        </div>

        <!-- Loading -->
        <div class="loading" id="loadingMessage" style="display: none;">
            üîÑ Player-ek bet√∂lt√©se folyamatban... K√©rlek v√°rj!
        </div>

        <!-- Vide√≥s Player Kont√©ner -->
        <div class="video-container">
            <div class="video-title">üé¨ Aktu√°lis Vide√≥k - GitHub Pages Domain</div>
            <div class="video-grid" id="videoGrid">
                <!-- Vide√≥k ide ker√ºlnek dinamikusan -->
            </div>
        </div>

        <p class="tip">
            ‚úÖ 100 vide√≥ dinamikus batch-ekben (15-20 vide√≥/batch)<br>
            üîÑ Automatikus ism√©tl√©s 3-6 perc k√∂z√∂tt v√©letlenszer≈±en<br>
            ‚è±Ô∏è Batch id≈ëtartam 4-8 perc k√∂z√∂tt v√©letlenszer≈±en<br>
            üé¨ Vide√≥s player-ek - CSAK KATTINT√ÅSRA indulnak<br>
            üåê GitHub Pages domain - optim√°lis YouTube rekl√°mokhoz<br>
            üí∞ Rekl√°m bev√©tel k√∂vet√©s - becs√ºlt j√∂vedelem<br>
            üìä Statisztik√°k - lej√°tsz√°sok sz√°m√°nak nyomonk√∂vet√©se<br>
            üñ±Ô∏è Automatikus kattint√°sok v√©letlenszer≈± id≈ëk√∂z√∂nk√©nt
        </p>
    </div>

    <!-- YouTube IFrame API -->
    <script src="https://www.youtube.com/iframe_api"></script>
    
    <script>
        // Konfigur√°ci√≥ GitHub Pages-hez
        const CONFIG = {
            BATCH: {
                MIN_SIZE: 15,
                MAX_SIZE: 20,
                TARGET_TOTAL: 100
            },
            
            TIMING: {
                MIN_DURATION: 240,    // 4 perc
                MAX_DURATION: 480,    // 8 perc
                MIN_REPEAT: 3,        // 3 perc
                MAX_REPEAT: 6         // 6 perc
            },
            
            CLICK_DELAY: {
                MIN: 2000,            // 2 m√°sodperc
                MAX: 10000            // 10 m√°sodperc
            },
            
            // GitHub Pages domain konfigur√°ci√≥
            DOMAIN: {
                ORIGIN: window.location.origin,
                IS_GITHUB_PAGES: window.location.hostname.includes('github.io')
            }
        };

        // YouTube video ID-k - 100 vide√≥
        const allYouTubeLinks = [
            "cMp-R_FqtQA", "aZgSNIe6cBY", "bOopMi29kRY", "tYuYJ1hIsi8", "4-WtHjXLNCo",
            "-uhGPF_cgOk", "kWDoWMdbGMA", "ZVWzoHpir5U", "orylSDsIgnI", "wn73hwpvW8A",
            "l9pltc3Hb9I", "hCZLWDi2IR8", "cwOHVbr7Vkc", "BvHsut1cDYk", "pzp6QRNMeXE",
            "AVZjk1IO1nM", "Czg-kJ0bi7U", "F3hjmIFCIis", "TTEP3yTfN3E", "UWIVJzuN640",
            "6_bL4LYsap8", "VEpxpFGuCzc", "rWKMZRJw9Co", "OIKfpX9MOUw", "VzNrZ-62n7E",
            "f8BCZZl6Vzw", "6bT_V7GV2t4", "YrUiKHPuHwI", "bcQypBjDoYY", "6a8_VRHJByQ",
            "nB-GkX4Bjr8", "8CMER1ePJ3E", "TfwdiIKHsuA", "mXD8IEpOi3Y", "KBY-LTyNtUo",
            "UTiYkI2MkJs", "1v6lzdZajrc", "xbEAO9qyU9A", "qH5kYkXbjGM", "OcCyAFWm4fA",
            "PKXWWamkWns", "wfa75c14lLM", "7HragoeZlOA", "jOD9SMgq9-c", "fZCExIFptRg",
            "qfWPq0U_2jM", "vnGMYPNxIN8", "-TNgmGmN0Ak", "smUEglbjtqM", "nZl84m9n6Gk",
            "E4-lYY-DPkw", "8GxdKF15a6k", "L-gwG1wZLDQ", "pvnL2LSabeg", "3fFB3dhajLM",
            "zvZrZ76aBnY", "ShkG6Ph2oiE", "3dl7fSt2oCA", "rSxwTDNwdQs", "Twfx_0KXmjY",
            "l8y9-J7WCwg", "xLF3inAjywY", "W-QW_w3vPO0", "aV78cB-YKdM", "kua-4tBkvfM",
            "iUWLkoPFqgc", "9TVFHnk5hlA", "fPz9CctBNOs", "v3HDlcXnPpg", "hHDB_gTuCOc",
            "epi-kCVvNSo", "alVH5TBswfA", "8fzcEY2JjyQ", "f1AUwkaBJXE", "W-PvCCMijMs",
            "ppJmqLHXSQI", "4xuAWpUtmq0", "Ot7vtGtTM-I", "F_6GiGlsOBI", "ot9Bilqh6lA",
            "Plfh8_bcdIY", "MUtUxi1L2jLg", "qLD50U4kIJQ", "kfLNXrYzRio", "Ckl-9Cp_F6I",
            "IleqlrxKbac", "ia43xYLjEx8", "ULsVGPcBEAw", "6GZ39I1WgX4", "n9aHRHX0Jwo",
            "nVYF-WJE6to", "R8YcpZ-klGM", "jpEbpRzMZS0", "CzJgrJhfvJA", "BJOKOxwZ8hQ",
            "7JJ_NOmnTNI", "xeXUl0ZGfek", "1PrTEj-czks", "nYl9il7yTXM", "fC0cIXaDQdk"
        ];

        // Dinamikus batch gener√°l√°s
        function generateDynamicBatches() {
            let batches = [];
            let remainingZones = CONFIG.BATCH.TARGET_TOTAL;
            let batchNumber = 1;
            
            while (remainingZones > 0) {
                const maxBatchSize = Math.min(CONFIG.BATCH.MAX_SIZE, remainingZones);
                const minBatchSize = Math.min(CONFIG.BATCH.MIN_SIZE, remainingZones);
                
                const batchSize = Math.floor(
                    Math.random() * (maxBatchSize - minBatchSize + 1)
                ) + minBatchSize;
                
                const startIndex = batches.reduce((sum, batch) => sum + batch.size, 0);
                const endIndex = startIndex + batchSize - 1;
                
                batches.push({
                    start: startIndex,
                    end: endIndex,
                    size: batchSize,
                    name: `Batch ${batchNumber}`,
                    duration: getRandomDuration()
                });
                
                remainingZones -= batchSize;
                batchNumber++;
            }
            
            return batches;
        }

        // V√©letlenszer≈± id≈ëtartam
        function getRandomDuration() {
            return Math.floor(
                Math.random() * (CONFIG.TIMING.MAX_DURATION - CONFIG.TIMING.MIN_DURATION + 1)
            ) + CONFIG.TIMING.MIN_DURATION;
        }

        // V√©letlenszer≈± ism√©tl√©si id≈ë
        function getRandomRepeatDuration() {
            return Math.floor(Math.random() * (CONFIG.TIMING.MAX_REPEAT - CONFIG.TIMING.MIN_REPEAT + 1)) 
                   + CONFIG.TIMING.MIN_REPEAT;
        }

        // Dinamikus batch-ek
        let batches = generateDynamicBatches();

        let youtubePlayers = new Array(allYouTubeLinks.length);
        let playersReady = 0;
        let activePlayers = 0;
        let currentBatchIndex = -1;
        let isLoading = false;
        let timerInterval = null;
        let timeLeft = 0;
        let autoRepeatInterval = null;
        let isAutoRepeatActive = false;
        let nextRepeatTime = null;
        let repeatDuration = 0;
        let clickTimeouts = [];
        
        // Lej√°tsz√°si statisztik√°k
        let playbackStats = {
            totalPlaybacks: 0,
            monthlyStats: {}
        };

        // Rekl√°m statisztik√°k
        let adStats = {
            totalAds: 0,
            successfulAds: 0,
            estimatedRevenue: 0,
            adEvents: []
        };

        // ========== VIDE√ìS PLAYER FUNKCI√ìK ==========

        // Vide√≥ player l√©trehoz√°sa - GitHub Pages optimaliz√°lt
        function createVideoPlayer(videoId, index) {
            return new Promise((resolve) => {
                const videoGrid = document.getElementById('videoGrid');
                
                const videoPlayer = document.createElement('div');
                videoPlayer.className = 'video-player';
                videoPlayer.id = `videoPlayer${index}`;
                
                const playerContainer = document.createElement('div');
                playerContainer.className = 'player-container';
                playerContainer.id = `playerContainer${index}`;
                
                const playButton = document.createElement('div');
                playButton.className = 'play-button';
                playButton.innerHTML = '‚ñ∂';
                playButton.id = `playButton${index}`;
                
                const clickMessage = document.createElement('div');
                clickMessage.className = 'click-message';
                clickMessage.textContent = 'Kattints a lej√°tsz√°shoz';
                
                const adIndicator = document.createElement('div');
                adIndicator.className = 'ad-indicator';
                adIndicator.id = `adIndicator${index}`;
                adIndicator.textContent = '‚è≥ Rekl√°m';
                adIndicator.style.display = 'none';
                
                const videoInfo = document.createElement('div');
                videoInfo.className = 'video-info';
                videoInfo.textContent = `Vide√≥ ${index + 1}`;
                
                playerContainer.appendChild(playButton);
                playerContainer.appendChild(clickMessage);
                playerContainer.appendChild(adIndicator);
                videoPlayer.appendChild(playerContainer);
                videoPlayer.appendChild(videoInfo);
                videoGrid.appendChild(videoPlayer);
                
                // YouTube Player l√©trehoz√°sa GitHub Pages origin-nal
                new YT.Player(`playerContainer${index}`, {
                    height: '140',
                    width: '100%',
                    videoId: videoId,
                    playerVars: {
                        'playsinline': 1,
                        'enablejsapi': 1,
                        'origin': CONFIG.DOMAIN.ORIGIN, // GitHub Pages domain
                        'rel': 0,
                        'modestbranding': 1,
                        'controls': 1,
                        'showinfo': 0,
                        'iv_load_policy': 3,
                        'autoplay': 0,   // NINCS automatikus ind√≠t√°s
                        'fs': 0
                    },
                    events: {
                        'onReady': function(event) {
                            youtubePlayers[index] = event.target;
                            playersReady++;
                            updateStats();
                            
                            // Play gomb esem√©nykezel≈ë hozz√°ad√°sa
                            playButton.addEventListener('click', function() {
                                manualVideoStart(index);
                            });
                            
                            resolve(event.target);
                        },
                        'onStateChange': function(event) {
                            if (event.data === YT.PlayerState.PLAYING) {
                                activePlayers++;
                                updateStats();
                                // Play gomb elrejt√©se lej√°tsz√°s k√∂zben
                                playButton.style.display = 'none';
                                
                                // Lej√°tsz√°s statisztika friss√≠t√©se
                                playbackStats.totalPlaybacks++;
                                updatePlaybackStats();
                            } else if (event.data === YT.PlayerState.PAUSED || event.data === YT.PlayerState.ENDED) {
                                activePlayers = Math.max(0, activePlayers - 1);
                                updateStats();
                                // Play gomb megjelen√≠t√©se sz√ºneteltet√©skor
                                if (event.data === YT.PlayerState.PAUSED) {
                                    playButton.style.display = 'flex';
                                }
                            }
                            
                            // Rekl√°m √°llapot k√∂vet√©se
                            trackAdState(event, index);
                        },
                        'onError': function(event) {
                            console.error(`Hiba a player ${index + 1}-n√©l:`, event.data);
                            resolve(null);
                        }
                    }
                });
            });
        }

        // Manu√°lis vide√≥ ind√≠t√°s (kattint√°sra)
        function manualVideoStart(index) {
            const player = youtubePlayers[index];
            const playButton = document.getElementById(`playButton${index}`);
            
            if (player && typeof player.playVideo === 'function') {
                try {
                    playButton.style.display = 'none';
                    player.playVideo();
                    console.log(`‚úÖ Vide√≥ ${index + 1} elind√≠tva k√©zi kattint√°ssal`);
                } catch (e) {
                    console.log(`Hiba a vide√≥ ind√≠t√°s√°n√°l:`, e);
                    playButton.style.display = 'flex';
                }
            }
        }

        // Programozott kattint√°s szimul√°ci√≥
        function simulateProgrammedClicks() {
            if (currentBatchIndex < 0) return;
            
            const batch = batches[currentBatchIndex];
            let batchPlayers = youtubePlayers.slice(batch.start, batch.end + 1)
                .filter(player => player !== undefined && player !== null);
            
            // T√∂r√∂lj√ºk a kor√°bbi id≈ëz√≠t√©seket
            clickTimeouts.forEach(timeout => clearTimeout(timeout));
            clickTimeouts = [];
            
            // V√©letlenszer≈± id≈ëk√∂z√∂nk√©nti kattint√°sok szimul√°l√°sa
            batchPlayers.forEach((player, index) => {
                const clickDelay = Math.random() * (CONFIG.CLICK_DELAY.MAX - CONFIG.CLICK_DELAY.MIN) + CONFIG.CLICK_DELAY.MIN;
                
                const timeout = setTimeout(() => {
                    const actualIndex = batch.start + index;
                    const playButton = document.getElementById(`playButton${actualIndex}`);
                    
                    if (playButton && playButton.style.display !== 'none') {
                        // L√°that√≥ play gombra kattintunk
                        manualVideoStart(actualIndex);
                        console.log(`ü§ñ Programozott kattint√°s a vide√≥ ${actualIndex + 1}-re`);
                    }
                }, clickDelay);
                
                clickTimeouts.push(timeout);
            });
            
            document.getElementById('statusMessage').innerHTML = 
                `‚úÖ ${batch.name} bet√∂ltve!<br>ü§ñ Programozott kattint√°sok akt√≠vak<br>‚è±Ô∏è Id≈ëtartam: ${Math.floor(batches[currentBatchIndex].duration/60)} perc`;
        }

        // Rekl√°m √°llapot k√∂vet√©se
        function trackAdState(event, index) {
            const adIndicator = document.getElementById(`adIndicator${index}`);
            const playButton = document.getElementById(`playButton${index}`);
            
            switch (event.data) {
                case YT.PlayerState.AD_PLAYING:
                    adIndicator.style.display = 'block';
                    adIndicator.textContent = 'üì∫ Rekl√°m';
                    adIndicator.style.background = 'rgba(255, 193, 7, 0.9)';
                    playButton.style.display = 'none';
                    adStats.totalAds++;
                    updateAdStats();
                    break;
                    
                case YT.PlayerState.PLAYING:
                    // Ha a rekl√°m ut√°n j√∂n a vide√≥, akkor sikeres rekl√°m
                    if (adIndicator.style.display === 'block') {
                        adStats.successfulAds++;
                        adStats.estimatedRevenue += 0.01;
                        updateAdStats();
                    }
                    adIndicator.style.display = 'none';
                    break;
                    
                case YT.PlayerState.BUFFERING:
                    adIndicator.style.display = 'block';
                    adIndicator.textContent = '‚è≥ Bet√∂lt√©s';
                    adIndicator.style.background = 'rgba(33, 150, 243, 0.9)';
                    break;
                    
                case YT.PlayerState.PAUSED:
                    playButton.style.display = 'flex';
                    break;
            }
        }

        // Rekl√°m statisztik√°k friss√≠t√©se
        function updateAdStats() {
            document.getElementById('totalAds').textContent = adStats.totalAds;
            document.getElementById('successfulAds').textContent = adStats.successfulAds;
            document.getElementById('adRevenue').textContent = adStats.estimatedRevenue.toFixed(2);
        }

        // ========== ALAP FUNKCI√ìK ==========

        // Statisztik√°k friss√≠t√©se
        function updateStats() {
            document.getElementById('readyCount').textContent = playersReady;
            document.getElementById('activeCount').textContent = activePlayers;
            
            const progress = (playersReady / allYouTubeLinks.length) * 100;
            document.getElementById('loadProgress').style.width = progress + '%';
            
            document.getElementById('currentBatch').textContent = currentBatchIndex >= 0 ? batches[currentBatchIndex].name : '-';
        }

        // Timer friss√≠t√©se
        function updateTimer() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('timer').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // Automatikus ism√©tl√©s inform√°ci√≥k friss√≠t√©se
        function updateAutoRepeatInfo() {
            document.getElementById('autoStatus').textContent = isAutoRepeatActive ? 'Akt√≠v' : 'Inakt√≠v';
            
            if (nextRepeatTime) {
                const now = new Date();
                const timeDiff = nextRepeatTime - now;
                
                if (timeDiff > 0) {
                    const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);
                    document.getElementById('nextStartTime').textContent = 
                        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                } else {
                    document.getElementById('nextStartTime').textContent = 'Hamarosan';
                }
            } else {
                document.getElementById('nextStartTime').textContent = '-';
            }
            
            document.getElementById('repeatDuration').textContent = repeatDuration;
        }

        // Lej√°tsz√°si statisztik√°k friss√≠t√©se
        function updatePlaybackStats() {
            document.getElementById('playbackCount').textContent = playbackStats.totalPlaybacks;
            
            // Havi statisztika
            const now = new Date();
            const monthKey = `${now.getFullYear()}. ${now.getMonth() + 1}.`;
            
            if (!playbackStats.monthlyStats[monthKey]) {
                playbackStats.monthlyStats[monthKey] = 0;
            }
            playbackStats.monthlyStats[monthKey]++;
            
            let monthlyHTML = 'Havi bont√°s:<br>';
            const months = Object.keys(playbackStats.monthlyStats).sort().reverse();
            
            months.forEach(month => {
                monthlyHTML += `<strong>${month}:</strong> ${playbackStats.monthlyStats[month]} db lej√°tsz√°s<br>`;
            });
            
            document.getElementById('monthlyStats').innerHTML = monthlyHTML;
            
            // Ment√©s localStorage-ba
            localStorage.setItem('playbackStats', JSON.stringify(playbackStats));
        }

        // Statisztik√°k bet√∂lt√©se localStorage-b√≥l
        function loadPlaybackStats() {
            const savedStats = localStorage.getItem('playbackStats');
            if (savedStats) {
                playbackStats = JSON.parse(savedStats);
            }
            updatePlaybackStats();
        }

        // K√∂vetkez≈ë ism√©tl√©s id≈ëpontj√°nak be√°ll√≠t√°sa
        function scheduleNextRepeat() {
            if (!isAutoRepeatActive) return;
            
            repeatDuration = getRandomRepeatDuration();
            const repeatMs = repeatDuration * 60 * 1000;
            
            nextRepeatTime = new Date(Date.now() + repeatMs);
            updateAutoRepeatInfo();
            
            if (autoRepeatInterval) clearTimeout(autoRepeatInterval);
            autoRepeatInterval = setTimeout(() => {
                if (isAutoRepeatActive) {
                    document.getElementById('statusMessage').innerHTML = 'üîÑ Automatikus ism√©tl√©s ind√≠t√°sa...';
                    nextBatch();
                }
            }, repeatMs);
        }

        // Timer ind√≠t√°sa
        function startTimer(duration = null) {
            timeLeft = duration || getRandomDuration();
            updateTimer();
            
            if (timerInterval) clearInterval(timerInterval);
            
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimer();
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    finishBatch();
                }
            }, 1000);
        }

        // Batch befejez√©se
        function finishBatch() {
            // T√∂r√∂lj√ºk a kattint√°s id≈ëz√≠t√©seket
            clickTimeouts.forEach(timeout => clearTimeout(timeout));
            clickTimeouts = [];
            
            if (currentBatchIndex >= 0) {
                clearBatch(currentBatchIndex);
            }
            
            currentBatchIndex++;
            
            if (currentBatchIndex >= batches.length) {
                document.getElementById('statusMessage').innerHTML = '‚úÖ Minden batch lej√°tszva!';
                
                if (isAutoRepeatActive) {
                    document.getElementById('statusMessage').innerHTML += '<br>üîÑ Automatikus ism√©tl√©s be√°ll√≠t√°sa...';
                    
                    currentBatchIndex = -1;
                    batches = generateDynamicBatches();
                    updateBatchProgress();
                    scheduleNextRepeat();
                } else {
                    document.getElementById('startButton').disabled = false;
                }
                return;
            }
            
            const batch = batches[currentBatchIndex];
            document.getElementById('statusMessage').innerHTML = `${batch.name} bet√∂lt√©se...`;
            
            updateBatchProgress();
            loadPlayersFromBatch(batch);
        }

        // Batch bet√∂lt√©se
        function loadPlayersFromBatch(batch) {
            const videoGrid = document.getElementById('videoGrid');
            videoGrid.innerHTML = '';
            
            let currentIndex = batch.start;
            let loadedCount = 0;
            const batchSize = batch.end - batch.start + 1;

            function loadNextPlayer() {
                if (currentIndex > batch.end) {
                    // Minden player bet√∂ltve
                    isLoading = false;
                    document.getElementById('loadingMessage').style.display = 'none';
                    
                    // Programozott kattint√°sok ind√≠t√°sa
                    simulateProgrammedClicks();
                    startTimer(batches[currentBatchIndex].duration);
                    return;
                }

                const videoId = allYouTubeLinks[currentIndex];
                
                createVideoPlayer(videoId, currentIndex).then((player) => {
                    loadedCount++;
                    document.getElementById('batchInfo').textContent = 
                        `${batch.name} - ${loadedCount}/${batchSize} vide√≥ bet√∂ltve`;
                    
                    // K√∂vetkez≈ë player bet√∂lt√©se r√∂vid k√©sleltet√©ssel
                    currentIndex++;
                    setTimeout(loadNextPlayer, 100);
                }).catch(error => {
                    console.error(`Hiba a player ${currentIndex} bet√∂lt√©s√©n√©l:`, error);
                    // Hiba eset√©n is folytatjuk a k√∂vetkez≈ëvel
                    currentIndex++;
                    setTimeout(loadNextPlayer, 100);
                });
            }

            isLoading = true;
            document.getElementById('loadingMessage').style.display = 'block';
            document.getElementById('batchInfo').textContent = `${batch.name} bet√∂lt√©se...`;
            loadNextPlayer();
        }

        // Batch t√∂rl√©se a mem√≥ri√°b√≥l
        function clearBatch(batchIndex) {
            const batch = batches[batchIndex];
            
            // T√∂r√∂lj√ºk a kattint√°s id≈ëz√≠t√©seket
            clickTimeouts.forEach(timeout => clearTimeout(timeout));
            clickTimeouts = [];
            
            for (let i = batch.start; i <= batch.end; i++) {
                const videoPlayer = document.getElementById(`videoPlayer${i}`);
                if (videoPlayer) {
                    videoPlayer.remove();
                }
                youtubePlayers[i] = null;
            }
            
            playersReady -= batch.size;
            activePlayers = 0;
            updateStats();
        }

        // Dinamikus batch progress friss√≠t√©s
        function updateBatchProgress() {
            const container = document.getElementById('batchProgressContainer');
            container.innerHTML = '';
            
            batches.forEach((batch, index) => {
                const step = document.createElement('div');
                step.className = `batch-step ${index === currentBatchIndex ? 'active' : ''} ${index < currentBatchIndex ? 'completed' : ''}`;
                step.id = `batch${index + 1}Step`;
                
                step.innerHTML = `
                    <div style="font-weight: bold; margin-bottom: 5px;">${batch.name}</div>
                    <div style="font-size: 0.9rem; opacity: 0.8;">(${batch.start + 1}-${batch.end + 1})</div>
                    <div style="font-size: 0.8rem; margin-top: 5px; color: #ffd93d;">${Math.floor(batch.duration/60)}p</div>
                `;
                
                container.appendChild(step);
            });
        }

        // Automatikus ism√©tl√©s ind√≠t√°sa
        function startAutoRepeat() {
            isAutoRepeatActive = true;
            document.getElementById('autoButton').textContent = '‚è∏Ô∏è Automatikus Ism√©tl√©s Sz√ºneteltet√©se';
            document.getElementById('statusMessage').innerHTML = 'üîÑ Automatikus ism√©tl√©s aktiv√°lva!';
            
            if (currentBatchIndex < 0) {
                document.getElementById('startButton').disabled = true;
                nextBatch();
            } else {
                scheduleNextRepeat();
            }
            
            updateAutoRepeatInfo();
        }

        // Automatikus ism√©tl√©s le√°ll√≠t√°sa
        function stopAutoRepeat() {
            isAutoRepeatActive = false;
            document.getElementById('autoButton').textContent = 'üîÅ Automatikus Ism√©tl√©s';
            document.getElementById('statusMessage').innerHTML = '‚è∏Ô∏è Automatikus ism√©tl√©s sz√ºneteltetve';
            
            if (autoRepeatInterval) {
                clearTimeout(autoRepeatInterval);
                autoRepeatInterval = null;
            }
            
            updateAutoRepeatInfo();
        }

        // Minden le√°ll√≠t√°sa
        function stopAll() {
            // T√∂r√∂lj√ºk az id≈ëz√≠t√©seket
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            
            clickTimeouts.forEach(timeout => clearTimeout(timeout));
            clickTimeouts = [];
            
            if (autoRepeatInterval) {
                clearTimeout(autoRepeatInterval);
                autoRepeatInterval = null;
            }
            
            stopAutoRepeat();
            
            // Le√°ll√≠tjuk a vide√≥kat
            if (currentBatchIndex >= 0) {
                const batch = batches[currentBatchIndex];
                const batchPlayers = youtubePlayers.slice(batch.start, batch.end + 1)
                    .filter(player => player !== undefined && player !== null);
                
                batchPlayers.forEach((player) => {
                    if (player && typeof player.stopVideo === 'function') {
                        try {
                            player.stopVideo();
                        } catch (e) {
                            console.log('Hiba a player le√°ll√≠t√°s√°n√°l:', e);
                        }
                    }
                });
            }
            
            activePlayers = 0;
            currentBatchIndex = -1;
            timeLeft = 0;
            updateTimer();
            document.getElementById('timerLabel').textContent = 'V√°rakoz√°s batch bet√∂lt√©s√©re';
            updateStats();
            
            document.getElementById('statusMessage').innerHTML = '‚èπÔ∏è Minden le√°ll√≠tva!';
            document.getElementById('startButton').disabled = false;
            document.getElementById('batchInfo').textContent = 'Kattints a "Batch Bet√∂lt√©se" gombra a vide√≥k bet√∂lt√©s√©hez';
            
            updateBatchProgress();
        }

        // K√∂vetkez≈ë batch bet√∂lt√©se
        function nextBatch() {
            if (currentBatchIndex >= 0) {
                clearBatch(currentBatchIndex);
            }
            
            currentBatchIndex++;
            
            if (currentBatchIndex >= batches.length) {
                document.getElementById('statusMessage').innerHTML = '‚úÖ Minden batch lej√°tszva!';
                
                if (isAutoRepeatActive) {
                    document.getElementById('statusMessage').innerHTML += '<br>üîÑ Automatikus ism√©tl√©s be√°ll√≠t√°sa...';
                    
                    currentBatchIndex = -1;
                    batches = generateDynamicBatches();
                    updateBatchProgress();
                    scheduleNextRepeat();
                } else {
                    document.getElementById('startButton').disabled = false;
                }
                return;
            }
            
            const batch = batches[currentBatchIndex];
            document.getElementById('statusMessage').innerHTML = `${batch.name} bet√∂lt√©se...`;
            
            updateBatchProgress();
            loadPlayersFromBatch(batch);
        }

        // ========== ESEM√âNYKEZEL≈êK ==========

        // Ind√≠t√°s gomb
        document.getElementById('startButton').addEventListener('click', function() {
            this.disabled = true;
            document.getElementById('statusMessage').innerHTML = 'üöÄ Batch bet√∂lt√©se...';
            currentBatchIndex = -1;
            batches = generateDynamicBatches();
            updateBatchProgress();
            nextBatch();
        });

        // Automatikus ism√©tl√©s gomb
        document.getElementById('autoButton').addEventListener('click', function() {
            if (isAutoRepeatActive) {
                stopAutoRepeat();
            } else {
                startAutoRepeat();
            }
        });

        // Le√°ll√≠t√°s gomb
        document.getElementById('stopButton').addEventListener('click', stopAll);

        // YouTube API bet√∂lt√©se
        function onYouTubeIframeAPIReady() {
            document.getElementById('statusMessage').textContent = 'YouTube API k√©sz! GitHub Pages domain akt√≠v.';
            document.getElementById('currentDomain').textContent = CONFIG.DOMAIN.ORIGIN;
            updateStats();
            updateTimer();
            updateAutoRepeatInfo();
            loadPlaybackStats();
            updateBatchProgress();
            updateAdStats();
        }

        // Oldal bet√∂lt√©sekor
        window.addEventListener('load', function() {
            updateStats();
            updateBatchProgress();
            updateAdStats();
            
            // Statisztik√°k bet√∂lt√©se
            loadPlaybackStats();
            
            // Domain inform√°ci√≥ friss√≠t√©se
            document.getElementById('currentDomain').textContent = window.location.origin;
        });
    </script>
</body>
</html>
